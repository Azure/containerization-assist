id: security-analysis
version: '1.0.0'
description: Analyze container configuration for security vulnerabilities
category: security
parameters:
  - name: configType
    type: string
    required: true
    description: Type of configuration (dockerfile, k8s-manifest)
  - name: content
    type: string
    required: false
    description: Configuration content to analyze
  - name: complianceStandard
    type: string
    required: false
    description: Compliance standard to check against (CIS, NIST, SOC2)
  - name: environment
    type: string
    required: false
    description: Target environment for production-specific checks
template: |+
  Analyze {{configType}} configuration for security vulnerabilities.
  Apply {{complianceStandard}} compliance checks.


  Configuration to analyze:
  {{content}}


  Analysis should include:
  - Vulnerability assessment
  - Best practice compliance
  - Risk evaluation
  - Remediation recommendations

  {{#if (eq environment "production")}}
  - Production-specific security checks
  {{/if}}

format: text
