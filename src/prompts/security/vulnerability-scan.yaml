id: vulnerability-scan
version: '1.0.0'
description: AI-powered vulnerability assessment and remediation recommendations
category: security
parameters:
  - name: imageName
    type: string
    required: true
    description: Docker image to scan
  - name: scannerType
    type: string
    required: false
    description: Type of scanner being used (trivy/grype/clair)
  - name: rawScanResults
    type: object
    required: false
    description: Raw scan results from the scanner
  - name: environment
    type: string
    required: false
    description: Target environment for deployment
  - name: severityThreshold
    type: string
    required: false
    description: Minimum severity to report (critical/high/medium/low)
  - name: sessionAnalysis
    type: object
    required: false
    description: Previous analysis from session
template: |
  Analyze vulnerability scan results and provide remediation recommendations.

  Scan Target:
  - Image: {{imageName}}

  - Scanner: {{scannerType}}


  - Target Environment: {{environment}}


  - Severity Threshold: {{severityThreshold}}



  Scan Results:
  {{rawScanResults}}



  Related Analysis:
  {{sessionAnalysis}}



  CVE Patterns and Remediation:
  {{knowledge}}



  Security Policies:
  {{policy}}


  Provide a JSON response with the following structure:
  ```json
  {
    "summary": {
      "totalVulnerabilities": number,
      "critical": number,
      "high": number,
      "medium": number,
      "low": number,
      "negligible": number
    },
    "topVulnerabilities": [
      {
        "id": "string (CVE-ID)",
        "severity": "string",
        "package": "string",
        "version": "string",
        "fixedVersion": "string",
        "description": "string",
        "exploitability": "string (high|medium|low|none)"
      }
    ],
    "remediations": [
      {
        "priority": "string (immediate|high|medium|low)",
        "action": "string",
        "packages": ["string"],
        "effort": "string (low|medium|high)",
        "impact": "string"
      }
    ],
    "baseImageRecommendations": [
      {
        "currentBase": "string",
        "recommendedBase": "string",
        "reason": "string",
        "vulnerabilityReduction": number
      }
    ],
    "complianceStatus": {
      "passes": boolean,
      "blockers": ["string"],
      "warnings": ["string"]
    },
    "riskScore": {
      "score": number,
      "level": "string (critical|high|medium|low)",
      "factors": ["string"]
    },
    "deploymentRecommendation": {
      "canDeploy": boolean,
      "conditions": ["string"],
      "requiredActions": ["string"]
    },
    "nextSteps": ["string"]
  }
  ```

  Focus on actionable remediation steps that balance security with practicality.
format: json
